digraph GCD_FSM {
    rankdir=LR;
    size="8,5";
    node [shape = ellipse, fixedsize=true, width=2, height=2];

    idle       [label="idle"];
    load_a     [label="load_a\n(req=1, ack=1)"];
    release_btn [label="release_btn\n(req=0)"];
    load_b     [label="load_b\n(req=1)"];
    compare    [label="compare"];
    subtract_a [label="subtract_a\n(reg_a = reg_a - reg_b)"];
    subtract_b [label="subtract_b\n(reg_b = reg_b - reg_a)"];
    done       [label="done\n(ack=1, C=reg_a)"];

    idle -> load_a      [label="req = 1"];
    load_a -> release_btn [label="req = 0"];
    release_btn -> load_b [label="req = 0"];
    load_b -> compare    [label="req = 1"];

    compare -> done      [label="reg_a = reg_b"];
    compare -> done      [label="reg_a = 0 -> reg_a = reg_b"];
    compare -> done      [label="reg_b = 0"];
    compare -> subtract_a [label="reg_a > reg_b"];
    compare -> subtract_b [label="reg_a < reg_b"];

    subtract_a -> compare [label="subtract_a"];
    subtract_b -> compare [label="subtract_b"];

    done -> idle         [label="(Reset/Finish)"];
}